if(WIN32)
    set(CPACK_GENERATOR "WIX")
    
    # Генерация GUID
    string(UUID CPACK_WIX_PRODUCT_GUID NAMESPACE "00000000-0000-0000-0000-000000000000" NAME "solver" TYPE SHA1)
    string(UUID CPACK_WIX_UPGRADE_GUID NAMESPACE "${CPACK_WIX_PRODUCT_GUID}" NAME "upgrade" TYPE SHA1)
    
    # Основные настройки
    set(CPACK_WIX_LICENSE_RTF "${CMAKE_CURRENT_SOURCE_DIR}/License.rtf")
    set(CPACK_WIX_CULTURES "en-US;ru-RU")
    set(CPACK_WIX_ARCHITECTURE "x64")
    set(CPACK_WIX_PRODUCT_ICON "${CMAKE_CURRENT_SOURCE_DIR}/assets/icon.ico")
    set(CPACK_WIX_UI_REF "WixUI_InstallDir")
    set(CPACK_WIX_EXTENSIONS "WixUtilExtension")
    set(CPACK_WIX_TEMPLATE "${CMAKE_CURRENT_SOURCE_DIR}/WixCultureFix.wxs")
    
    # Явное указание переменных для шаблона
    set(CPACK_WIX_PRODUCT_NAME "${CPACK_PACKAGE_NAME}")
    set(CPACK_WIX_UPGRADE_CODE "${CPACK_WIX_UPGRADE_GUID}")
    set(CPACK_WIX_PRODUCT_VERSION "${PROJECT_VERSION}")
    set(CPACK_WIX_PRODUCT_MANUFACTURER "${CPACK_PACKAGE_VENDOR}")
endif()
